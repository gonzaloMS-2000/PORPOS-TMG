---
title: "Iteration of Choice Specific Variables"
output: html_notebook
---

In this notebook we iterate through a simple multinomial __Mode Choice model__, where each run contains a different choice specific variable. Each run also looks at two different reference modes (Auto and Active).

```{r}
library(mlogit)
library(data.table)

# Read ModeChoice_input.csv
df <- read.csv("C:/Users/gonza/Desktop/MChInput_2015_withColumns.csv")
df$Mode = as.factor(df$Mode)
df$Income = as.factor(df$Income)
df$Status = as.factor(df$Status)
df$Gender = as.factor(df$Gender)
df$Licence = as.factor(df$Licence)
df$Work = as.factor(df$Work)
df$Family = as.factor(df$Family)
df$Level = as.factor(df$Level)

head(df)
str(df)

# Remove outliers
df_mode <- df[!(df$Time.Active > 600),]
df_mode <- df_mode[!(df_mode$Time.Transit > 200),]
df_mode <- df_mode[!(df_mode$Time.Auto > 150),]

# Transform dataframe from wide to long
mldf = mlogit.data(df_mode, varying = 12:14, choice = "Mode", shape = "wide")
head(mldf)

# Headers of choice specific variables
df_headers = df
df_headers$Time.Auto = NULL
df_headers$Time.Active = NULL
df_headers$Time.Transit = NULL
headers = colnames(df_headers)

for (i in headers)
{
  # Run MNL model
  model = mlogit(Mode ~ 0|get(i)|Time, data = mldf, reflevel = "Auto")
  print(paste("CHOICE SPECIFIC VARIABLE: ",i))
  cat("\n\n---------------------------------------------------------------\n")
  cat("Referece: AUTO\n")
  print(summary(model))
  model = mlogit(Mode ~ 0|get(i)|Time, data = mldf, reflevel = "Active")
  cat("\n---------------------------------------------------------------\n")
  cat("Referece: ACTIVE\n")
  print(summary(model))
  cat("\n\n---------------------------------------------------------------\n---------------------------------------------------------------\n")
}
```

